{"ast":null,"code":"/**\n * Body.js\n *\n * Body interface provides common methods for Request and Response\n */\nimport Stream, { PassThrough } from 'node:stream';\nimport { types, deprecate, promisify } from 'node:util';\nimport { Buffer } from 'node:buffer';\nimport Blob from 'fetch-blob';\nimport { FormData, formDataToBlob } from 'formdata-polyfill/esm.min.js';\nimport { FetchError } from './errors/fetch-error.js';\nimport { FetchBaseError } from './errors/base.js';\nimport { isBlob, isURLSearchParameters } from './utils/is.js';\nconst pipeline = promisify(Stream.pipeline);\nconst INTERNALS = Symbol('Body internals');\n/**\n * Body mixin\n *\n * Ref: https://fetch.spec.whatwg.org/#body\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\n\nexport default class Body {\n  constructor(body) {\n    let {\n      size = 0\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let boundary = null;\n\n    if (body === null) {\n      // Body is undefined or null\n      body = null;\n    } else if (isURLSearchParameters(body)) {\n      // Body is a URLSearchParams\n      body = Buffer.from(body.toString());\n    } else if (isBlob(body)) {// Body is blob\n    } else if (Buffer.isBuffer(body)) {// Body is Buffer\n    } else if (types.isAnyArrayBuffer(body)) {\n      // Body is ArrayBuffer\n      body = Buffer.from(body);\n    } else if (ArrayBuffer.isView(body)) {\n      // Body is ArrayBufferView\n      body = Buffer.from(body.buffer, body.byteOffset, body.byteLength);\n    } else if (body instanceof Stream) {// Body is stream\n    } else if (body instanceof FormData) {\n      // Body is FormData\n      body = formDataToBlob(body);\n      boundary = body.type.split('=')[1];\n    } else {\n      // None of the above\n      // coerce to string then buffer\n      body = Buffer.from(String(body));\n    }\n\n    let stream = body;\n\n    if (Buffer.isBuffer(body)) {\n      stream = Stream.Readable.from(body);\n    } else if (isBlob(body)) {\n      stream = Stream.Readable.from(body.stream());\n    }\n\n    this[INTERNALS] = {\n      body,\n      stream,\n      boundary,\n      disturbed: false,\n      error: null\n    };\n    this.size = size;\n\n    if (body instanceof Stream) {\n      body.on('error', error_ => {\n        const error = error_ instanceof FetchBaseError ? error_ : new FetchError(`Invalid response body while trying to fetch ${this.url}: ${error_.message}`, 'system', error_);\n        this[INTERNALS].error = error;\n      });\n    }\n  }\n\n  get body() {\n    return this[INTERNALS].stream;\n  }\n\n  get bodyUsed() {\n    return this[INTERNALS].disturbed;\n  }\n  /**\n   * Decode response as ArrayBuffer\n   *\n   * @return  Promise\n   */\n\n\n  async arrayBuffer() {\n    const {\n      buffer,\n      byteOffset,\n      byteLength\n    } = await consumeBody(this);\n    return buffer.slice(byteOffset, byteOffset + byteLength);\n  }\n\n  async formData() {\n    const ct = this.headers.get('content-type');\n\n    if (ct.startsWith('application/x-www-form-urlencoded')) {\n      const formData = new FormData();\n      const parameters = new URLSearchParams(await this.text());\n\n      for (const [name, value] of parameters) {\n        formData.append(name, value);\n      }\n\n      return formData;\n    }\n\n    const {\n      toFormData\n    } = await import('./utils/multipart-parser.js');\n    return toFormData(this.body, ct);\n  }\n  /**\n   * Return raw response as Blob\n   *\n   * @return Promise\n   */\n\n\n  async blob() {\n    const ct = this.headers && this.headers.get('content-type') || this[INTERNALS].body && this[INTERNALS].body.type || '';\n    const buf = await this.arrayBuffer();\n    return new Blob([buf], {\n      type: ct\n    });\n  }\n  /**\n   * Decode response as json\n   *\n   * @return  Promise\n   */\n\n\n  async json() {\n    const text = await this.text();\n    return JSON.parse(text);\n  }\n  /**\n   * Decode response as text\n   *\n   * @return  Promise\n   */\n\n\n  async text() {\n    const buffer = await consumeBody(this);\n    return new TextDecoder().decode(buffer);\n  }\n  /**\n   * Decode response as buffer (non-spec api)\n   *\n   * @return  Promise\n   */\n\n\n  buffer() {\n    return consumeBody(this);\n  }\n\n}\nBody.prototype.buffer = deprecate(Body.prototype.buffer, 'Please use \\'response.arrayBuffer()\\' instead of \\'response.buffer()\\'', 'node-fetch#buffer'); // In browsers, all properties are enumerable.\n\nObject.defineProperties(Body.prototype, {\n  body: {\n    enumerable: true\n  },\n  bodyUsed: {\n    enumerable: true\n  },\n  arrayBuffer: {\n    enumerable: true\n  },\n  blob: {\n    enumerable: true\n  },\n  json: {\n    enumerable: true\n  },\n  text: {\n    enumerable: true\n  },\n  data: {\n    get: deprecate(() => {}, 'data doesn\\'t exist, use json(), text(), arrayBuffer(), or body instead', 'https://github.com/node-fetch/node-fetch/issues/1000 (response)')\n  }\n});\n/**\n * Consume and convert an entire Body to a Buffer.\n *\n * Ref: https://fetch.spec.whatwg.org/#concept-body-consume-body\n *\n * @return Promise\n */\n\nasync function consumeBody(data) {\n  if (data[INTERNALS].disturbed) {\n    throw new TypeError(`body used already for: ${data.url}`);\n  }\n\n  data[INTERNALS].disturbed = true;\n\n  if (data[INTERNALS].error) {\n    throw data[INTERNALS].error;\n  }\n\n  const {\n    body\n  } = data; // Body is null\n\n  if (body === null) {\n    return Buffer.alloc(0);\n  }\n  /* c8 ignore next 3 */\n\n\n  if (!(body instanceof Stream)) {\n    return Buffer.alloc(0);\n  } // Body is stream\n  // get ready to actually consume the body\n\n\n  const accum = [];\n  let accumBytes = 0;\n\n  try {\n    for await (const chunk of body) {\n      if (data.size > 0 && accumBytes + chunk.length > data.size) {\n        const error = new FetchError(`content size at ${data.url} over limit: ${data.size}`, 'max-size');\n        body.destroy(error);\n        throw error;\n      }\n\n      accumBytes += chunk.length;\n      accum.push(chunk);\n    }\n  } catch (error) {\n    const error_ = error instanceof FetchBaseError ? error : new FetchError(`Invalid response body while trying to fetch ${data.url}: ${error.message}`, 'system', error);\n    throw error_;\n  }\n\n  if (body.readableEnded === true || body._readableState.ended === true) {\n    try {\n      if (accum.every(c => typeof c === 'string')) {\n        return Buffer.from(accum.join(''));\n      }\n\n      return Buffer.concat(accum, accumBytes);\n    } catch (error) {\n      throw new FetchError(`Could not create Buffer from response body for ${data.url}: ${error.message}`, 'system', error);\n    }\n  } else {\n    throw new FetchError(`Premature close of server response while trying to fetch ${data.url}`);\n  }\n}\n/**\n * Clone body given Res/Req instance\n *\n * @param   Mixed   instance       Response or Request instance\n * @param   String  highWaterMark  highWaterMark for both PassThrough body streams\n * @return  Mixed\n */\n\n\nexport const clone = (instance, highWaterMark) => {\n  let p1;\n  let p2;\n  let {\n    body\n  } = instance[INTERNALS]; // Don't allow cloning a used body\n\n  if (instance.bodyUsed) {\n    throw new Error('cannot clone body after it is used');\n  } // Check that body is a stream and not form-data object\n  // note: we can't clone the form-data object without having it as a dependency\n\n\n  if (body instanceof Stream && typeof body.getBoundary !== 'function') {\n    // Tee instance body\n    p1 = new PassThrough({\n      highWaterMark\n    });\n    p2 = new PassThrough({\n      highWaterMark\n    });\n    body.pipe(p1);\n    body.pipe(p2); // Set instance body to teed body and return the other teed body\n\n    instance[INTERNALS].stream = p1;\n    body = p2;\n  }\n\n  return body;\n};\nconst getNonSpecFormDataBoundary = deprecate(body => body.getBoundary(), 'form-data doesn\\'t follow the spec and requires special treatment. Use alternative package', 'https://github.com/node-fetch/node-fetch/issues/1167');\n/**\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\n * specified in the specification:\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\n *\n * This function assumes that instance.body is present.\n *\n * @param {any} body Any options.body input\n * @returns {string | null}\n */\n\nexport const extractContentType = (body, request) => {\n  // Body is null or undefined\n  if (body === null) {\n    return null;\n  } // Body is string\n\n\n  if (typeof body === 'string') {\n    return 'text/plain;charset=UTF-8';\n  } // Body is a URLSearchParams\n\n\n  if (isURLSearchParameters(body)) {\n    return 'application/x-www-form-urlencoded;charset=UTF-8';\n  } // Body is blob\n\n\n  if (isBlob(body)) {\n    return body.type || null;\n  } // Body is a Buffer (Buffer, ArrayBuffer or ArrayBufferView)\n\n\n  if (Buffer.isBuffer(body) || types.isAnyArrayBuffer(body) || ArrayBuffer.isView(body)) {\n    return null;\n  }\n\n  if (body instanceof FormData) {\n    return `multipart/form-data; boundary=${request[INTERNALS].boundary}`;\n  } // Detect form data input from form-data module\n\n\n  if (body && typeof body.getBoundary === 'function') {\n    return `multipart/form-data;boundary=${getNonSpecFormDataBoundary(body)}`;\n  } // Body is stream - can't really do much about this\n\n\n  if (body instanceof Stream) {\n    return null;\n  } // Body constructor defaults other things to string\n\n\n  return 'text/plain;charset=UTF-8';\n};\n/**\n * The Fetch Standard treats this as if \"total bytes\" is a property on the body.\n * For us, we have to explicitly get it with a function.\n *\n * ref: https://fetch.spec.whatwg.org/#concept-body-total-bytes\n *\n * @param {any} obj.body Body object from the Body instance.\n * @returns {number | null}\n */\n\nexport const getTotalBytes = request => {\n  const {\n    body\n  } = request[INTERNALS]; // Body is null or undefined\n\n  if (body === null) {\n    return 0;\n  } // Body is Blob\n\n\n  if (isBlob(body)) {\n    return body.size;\n  } // Body is Buffer\n\n\n  if (Buffer.isBuffer(body)) {\n    return body.length;\n  } // Detect form data input from form-data module\n\n\n  if (body && typeof body.getLengthSync === 'function') {\n    return body.hasKnownLength && body.hasKnownLength() ? body.getLengthSync() : null;\n  } // Body is stream\n\n\n  return null;\n};\n/**\n * Write a Body to a Node.js WritableStream (e.g. http.Request) object.\n *\n * @param {Stream.Writable} dest The stream to write to.\n * @param obj.body Body object from the Body instance.\n * @returns {Promise<void>}\n */\n\nexport const writeToStream = async (dest, _ref) => {\n  let {\n    body\n  } = _ref;\n\n  if (body === null) {\n    // Body is null\n    dest.end();\n  } else {\n    // Body is stream\n    await pipeline(body, dest);\n  }\n};","map":{"version":3,"names":["Stream","PassThrough","types","deprecate","promisify","Buffer","Blob","FormData","formDataToBlob","FetchError","FetchBaseError","isBlob","isURLSearchParameters","pipeline","INTERNALS","Symbol","Body","constructor","body","size","boundary","from","toString","isBuffer","isAnyArrayBuffer","ArrayBuffer","isView","buffer","byteOffset","byteLength","type","split","String","stream","Readable","disturbed","error","on","error_","url","message","bodyUsed","arrayBuffer","consumeBody","slice","formData","ct","headers","get","startsWith","parameters","URLSearchParams","text","name","value","append","toFormData","blob","buf","json","JSON","parse","TextDecoder","decode","prototype","Object","defineProperties","enumerable","data","TypeError","alloc","accum","accumBytes","chunk","length","destroy","push","readableEnded","_readableState","ended","every","c","join","concat","clone","instance","highWaterMark","p1","p2","Error","getBoundary","pipe","getNonSpecFormDataBoundary","extractContentType","request","getTotalBytes","getLengthSync","hasKnownLength","writeToStream","dest","end"],"sources":["/home/jordanm/Documents/GitHub/SWE4103-Team-Project/ontrack/node_modules/node-fetch/src/body.js"],"sourcesContent":["\n/**\n * Body.js\n *\n * Body interface provides common methods for Request and Response\n */\n\nimport Stream, {PassThrough} from 'node:stream';\nimport {types, deprecate, promisify} from 'node:util';\nimport {Buffer} from 'node:buffer';\n\nimport Blob from 'fetch-blob';\nimport {FormData, formDataToBlob} from 'formdata-polyfill/esm.min.js';\n\nimport {FetchError} from './errors/fetch-error.js';\nimport {FetchBaseError} from './errors/base.js';\nimport {isBlob, isURLSearchParameters} from './utils/is.js';\n\nconst pipeline = promisify(Stream.pipeline);\nconst INTERNALS = Symbol('Body internals');\n\n/**\n * Body mixin\n *\n * Ref: https://fetch.spec.whatwg.org/#body\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nexport default class Body {\n\tconstructor(body, {\n\t\tsize = 0\n\t} = {}) {\n\t\tlet boundary = null;\n\n\t\tif (body === null) {\n\t\t\t// Body is undefined or null\n\t\t\tbody = null;\n\t\t} else if (isURLSearchParameters(body)) {\n\t\t\t// Body is a URLSearchParams\n\t\t\tbody = Buffer.from(body.toString());\n\t\t} else if (isBlob(body)) {\n\t\t\t// Body is blob\n\t\t} else if (Buffer.isBuffer(body)) {\n\t\t\t// Body is Buffer\n\t\t} else if (types.isAnyArrayBuffer(body)) {\n\t\t\t// Body is ArrayBuffer\n\t\t\tbody = Buffer.from(body);\n\t\t} else if (ArrayBuffer.isView(body)) {\n\t\t\t// Body is ArrayBufferView\n\t\t\tbody = Buffer.from(body.buffer, body.byteOffset, body.byteLength);\n\t\t} else if (body instanceof Stream) {\n\t\t\t// Body is stream\n\t\t} else if (body instanceof FormData) {\n\t\t\t// Body is FormData\n\t\t\tbody = formDataToBlob(body);\n\t\t\tboundary = body.type.split('=')[1];\n\t\t} else {\n\t\t\t// None of the above\n\t\t\t// coerce to string then buffer\n\t\t\tbody = Buffer.from(String(body));\n\t\t}\n\n\t\tlet stream = body;\n\n\t\tif (Buffer.isBuffer(body)) {\n\t\t\tstream = Stream.Readable.from(body);\n\t\t} else if (isBlob(body)) {\n\t\t\tstream = Stream.Readable.from(body.stream());\n\t\t}\n\n\t\tthis[INTERNALS] = {\n\t\t\tbody,\n\t\t\tstream,\n\t\t\tboundary,\n\t\t\tdisturbed: false,\n\t\t\terror: null\n\t\t};\n\t\tthis.size = size;\n\n\t\tif (body instanceof Stream) {\n\t\t\tbody.on('error', error_ => {\n\t\t\t\tconst error = error_ instanceof FetchBaseError ?\n\t\t\t\t\terror_ :\n\t\t\t\t\tnew FetchError(`Invalid response body while trying to fetch ${this.url}: ${error_.message}`, 'system', error_);\n\t\t\t\tthis[INTERNALS].error = error;\n\t\t\t});\n\t\t}\n\t}\n\n\tget body() {\n\t\treturn this[INTERNALS].stream;\n\t}\n\n\tget bodyUsed() {\n\t\treturn this[INTERNALS].disturbed;\n\t}\n\n\t/**\n\t * Decode response as ArrayBuffer\n\t *\n\t * @return  Promise\n\t */\n\tasync arrayBuffer() {\n\t\tconst {buffer, byteOffset, byteLength} = await consumeBody(this);\n\t\treturn buffer.slice(byteOffset, byteOffset + byteLength);\n\t}\n\n\tasync formData() {\n\t\tconst ct = this.headers.get('content-type');\n\n\t\tif (ct.startsWith('application/x-www-form-urlencoded')) {\n\t\t\tconst formData = new FormData();\n\t\t\tconst parameters = new URLSearchParams(await this.text());\n\n\t\t\tfor (const [name, value] of parameters) {\n\t\t\t\tformData.append(name, value);\n\t\t\t}\n\n\t\t\treturn formData;\n\t\t}\n\n\t\tconst {toFormData} = await import('./utils/multipart-parser.js');\n\t\treturn toFormData(this.body, ct);\n\t}\n\n\t/**\n\t * Return raw response as Blob\n\t *\n\t * @return Promise\n\t */\n\tasync blob() {\n\t\tconst ct = (this.headers && this.headers.get('content-type')) || (this[INTERNALS].body && this[INTERNALS].body.type) || '';\n\t\tconst buf = await this.arrayBuffer();\n\n\t\treturn new Blob([buf], {\n\t\t\ttype: ct\n\t\t});\n\t}\n\n\t/**\n\t * Decode response as json\n\t *\n\t * @return  Promise\n\t */\n\tasync json() {\n\t\tconst text = await this.text();\n\t\treturn JSON.parse(text);\n\t}\n\n\t/**\n\t * Decode response as text\n\t *\n\t * @return  Promise\n\t */\n\tasync text() {\n\t\tconst buffer = await consumeBody(this);\n\t\treturn new TextDecoder().decode(buffer);\n\t}\n\n\t/**\n\t * Decode response as buffer (non-spec api)\n\t *\n\t * @return  Promise\n\t */\n\tbuffer() {\n\t\treturn consumeBody(this);\n\t}\n}\n\nBody.prototype.buffer = deprecate(Body.prototype.buffer, 'Please use \\'response.arrayBuffer()\\' instead of \\'response.buffer()\\'', 'node-fetch#buffer');\n\n// In browsers, all properties are enumerable.\nObject.defineProperties(Body.prototype, {\n\tbody: {enumerable: true},\n\tbodyUsed: {enumerable: true},\n\tarrayBuffer: {enumerable: true},\n\tblob: {enumerable: true},\n\tjson: {enumerable: true},\n\ttext: {enumerable: true},\n\tdata: {get: deprecate(() => {},\n\t\t'data doesn\\'t exist, use json(), text(), arrayBuffer(), or body instead',\n\t\t'https://github.com/node-fetch/node-fetch/issues/1000 (response)')}\n});\n\n/**\n * Consume and convert an entire Body to a Buffer.\n *\n * Ref: https://fetch.spec.whatwg.org/#concept-body-consume-body\n *\n * @return Promise\n */\nasync function consumeBody(data) {\n\tif (data[INTERNALS].disturbed) {\n\t\tthrow new TypeError(`body used already for: ${data.url}`);\n\t}\n\n\tdata[INTERNALS].disturbed = true;\n\n\tif (data[INTERNALS].error) {\n\t\tthrow data[INTERNALS].error;\n\t}\n\n\tconst {body} = data;\n\n\t// Body is null\n\tif (body === null) {\n\t\treturn Buffer.alloc(0);\n\t}\n\n\t/* c8 ignore next 3 */\n\tif (!(body instanceof Stream)) {\n\t\treturn Buffer.alloc(0);\n\t}\n\n\t// Body is stream\n\t// get ready to actually consume the body\n\tconst accum = [];\n\tlet accumBytes = 0;\n\n\ttry {\n\t\tfor await (const chunk of body) {\n\t\t\tif (data.size > 0 && accumBytes + chunk.length > data.size) {\n\t\t\t\tconst error = new FetchError(`content size at ${data.url} over limit: ${data.size}`, 'max-size');\n\t\t\t\tbody.destroy(error);\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\taccumBytes += chunk.length;\n\t\t\taccum.push(chunk);\n\t\t}\n\t} catch (error) {\n\t\tconst error_ = error instanceof FetchBaseError ? error : new FetchError(`Invalid response body while trying to fetch ${data.url}: ${error.message}`, 'system', error);\n\t\tthrow error_;\n\t}\n\n\tif (body.readableEnded === true || body._readableState.ended === true) {\n\t\ttry {\n\t\t\tif (accum.every(c => typeof c === 'string')) {\n\t\t\t\treturn Buffer.from(accum.join(''));\n\t\t\t}\n\n\t\t\treturn Buffer.concat(accum, accumBytes);\n\t\t} catch (error) {\n\t\t\tthrow new FetchError(`Could not create Buffer from response body for ${data.url}: ${error.message}`, 'system', error);\n\t\t}\n\t} else {\n\t\tthrow new FetchError(`Premature close of server response while trying to fetch ${data.url}`);\n\t}\n}\n\n/**\n * Clone body given Res/Req instance\n *\n * @param   Mixed   instance       Response or Request instance\n * @param   String  highWaterMark  highWaterMark for both PassThrough body streams\n * @return  Mixed\n */\nexport const clone = (instance, highWaterMark) => {\n\tlet p1;\n\tlet p2;\n\tlet {body} = instance[INTERNALS];\n\n\t// Don't allow cloning a used body\n\tif (instance.bodyUsed) {\n\t\tthrow new Error('cannot clone body after it is used');\n\t}\n\n\t// Check that body is a stream and not form-data object\n\t// note: we can't clone the form-data object without having it as a dependency\n\tif ((body instanceof Stream) && (typeof body.getBoundary !== 'function')) {\n\t\t// Tee instance body\n\t\tp1 = new PassThrough({highWaterMark});\n\t\tp2 = new PassThrough({highWaterMark});\n\t\tbody.pipe(p1);\n\t\tbody.pipe(p2);\n\t\t// Set instance body to teed body and return the other teed body\n\t\tinstance[INTERNALS].stream = p1;\n\t\tbody = p2;\n\t}\n\n\treturn body;\n};\n\nconst getNonSpecFormDataBoundary = deprecate(\n\tbody => body.getBoundary(),\n\t'form-data doesn\\'t follow the spec and requires special treatment. Use alternative package',\n\t'https://github.com/node-fetch/node-fetch/issues/1167'\n);\n\n/**\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\n * specified in the specification:\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\n *\n * This function assumes that instance.body is present.\n *\n * @param {any} body Any options.body input\n * @returns {string | null}\n */\nexport const extractContentType = (body, request) => {\n\t// Body is null or undefined\n\tif (body === null) {\n\t\treturn null;\n\t}\n\n\t// Body is string\n\tif (typeof body === 'string') {\n\t\treturn 'text/plain;charset=UTF-8';\n\t}\n\n\t// Body is a URLSearchParams\n\tif (isURLSearchParameters(body)) {\n\t\treturn 'application/x-www-form-urlencoded;charset=UTF-8';\n\t}\n\n\t// Body is blob\n\tif (isBlob(body)) {\n\t\treturn body.type || null;\n\t}\n\n\t// Body is a Buffer (Buffer, ArrayBuffer or ArrayBufferView)\n\tif (Buffer.isBuffer(body) || types.isAnyArrayBuffer(body) || ArrayBuffer.isView(body)) {\n\t\treturn null;\n\t}\n\n\tif (body instanceof FormData) {\n\t\treturn `multipart/form-data; boundary=${request[INTERNALS].boundary}`;\n\t}\n\n\t// Detect form data input from form-data module\n\tif (body && typeof body.getBoundary === 'function') {\n\t\treturn `multipart/form-data;boundary=${getNonSpecFormDataBoundary(body)}`;\n\t}\n\n\t// Body is stream - can't really do much about this\n\tif (body instanceof Stream) {\n\t\treturn null;\n\t}\n\n\t// Body constructor defaults other things to string\n\treturn 'text/plain;charset=UTF-8';\n};\n\n/**\n * The Fetch Standard treats this as if \"total bytes\" is a property on the body.\n * For us, we have to explicitly get it with a function.\n *\n * ref: https://fetch.spec.whatwg.org/#concept-body-total-bytes\n *\n * @param {any} obj.body Body object from the Body instance.\n * @returns {number | null}\n */\nexport const getTotalBytes = request => {\n\tconst {body} = request[INTERNALS];\n\n\t// Body is null or undefined\n\tif (body === null) {\n\t\treturn 0;\n\t}\n\n\t// Body is Blob\n\tif (isBlob(body)) {\n\t\treturn body.size;\n\t}\n\n\t// Body is Buffer\n\tif (Buffer.isBuffer(body)) {\n\t\treturn body.length;\n\t}\n\n\t// Detect form data input from form-data module\n\tif (body && typeof body.getLengthSync === 'function') {\n\t\treturn body.hasKnownLength && body.hasKnownLength() ? body.getLengthSync() : null;\n\t}\n\n\t// Body is stream\n\treturn null;\n};\n\n/**\n * Write a Body to a Node.js WritableStream (e.g. http.Request) object.\n *\n * @param {Stream.Writable} dest The stream to write to.\n * @param obj.body Body object from the Body instance.\n * @returns {Promise<void>}\n */\nexport const writeToStream = async (dest, {body}) => {\n\tif (body === null) {\n\t\t// Body is null\n\t\tdest.end();\n\t} else {\n\t\t// Body is stream\n\t\tawait pipeline(body, dest);\n\t}\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}